
R version 2.11.1 (2010-05-31)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library( "micEconCES" )
Loading required package: systemfit
Loading required package: Matrix
Loading required package: lattice

Attaching package: 'Matrix'

The following object(s) are masked from 'package:base':

    det

Loading required package: car
Loading required package: MASS
Loading required package: nnet
Loading required package: survival
Loading required package: splines
Loading required package: lmtest
Loading required package: zoo
Loading required package: miscTools

Attaching package: 'miscTools'

The following object(s) are masked from 'package:car':

    coefTable

Loading required package: micEcon
Loading required package: np
Loading required package: boot

Attaching package: 'boot'

The following object(s) are masked from 'package:car':

    logit

The following object(s) are masked from 'package:survival':

    aml

The following object(s) are masked from 'package:lattice':

    melanoma

Loading required package: cubature
Nonparametric Kernel Methods for Mixed Datatypes (version 0.40-3)
Loading required package: minpack.lm
Loading required package: DEoptim
> library( "maxLik" )
> 
> data( "MishraCES" )
> 
> b <- c( "gamma_1" = 2, "gamma_2" = 200, "delta_1" = 0.6, "delta_2" = 0.7, 
+    "rho_1" = 0.5, "rho" = 0.6 )
> bVrs <- c( b, "nu" = 1.1 )
> xNames <- c( "X1", "X2", "X3" )
> 
> 
> ## checking cesCalc()
> MishraCES$Y3 <- cesCalc( xNames = xNames, 
+    data = MishraCES, coef = b, nested = TRUE )
> MishraCES$Y3
 [1]  7902.7144  3115.0095 18038.6412 12841.3618 25618.0842 14362.8728
 [7] 12558.9277 19647.9079  8873.7993   849.8061  7838.7631 14063.5320
[13] 12562.2859 11840.3051  4593.1907  5997.1839 11716.3041 18021.5140
[19] 16337.2284  8420.0520 11305.3668  3774.1896 10847.3177 18347.1065
[25] 21691.4598 20522.1938 24609.5139  3043.1897 10593.6813  6294.5970
[31] 11917.2396  5714.8498  6220.4375  2147.9573 11087.2036 18492.0974
[37] 16211.5198   796.7785 17901.0063 17932.9210   583.0910  5508.7455
[43]   710.4263  3325.9094 19155.3156 21179.0499 20744.4542  5293.2484
[49] 15602.5981  5985.8416
> 
> # VRS
> MishraCES$Y3Vrs <- cesCalc( xNames = xNames, 
+    data = MishraCES, coef = bVrs, nested = TRUE )
> MishraCES$Y3Vrs
 [1] 11414.3429  4099.2303 28295.7495 19470.1451 41619.6395 22022.2885
 [7] 18999.6157 31084.5759 12966.3447   982.0844 11312.7788 21517.9476
[13] 19005.2042 17807.2224  6283.8083  8426.3425 17602.1898 28266.1984
[19] 25374.2503 12238.9244 16924.2770  5062.9436 16171.5480 28828.4532
[25] 34658.8907 32609.4267 39820.8328  3995.3876 15756.0951  8887.1340
[31] 17934.5399  7991.0216  8772.0283  2723.4864 16565.3732 29079.1555
[37] 25159.5637   914.8889 28058.3540 28113.3850   648.9436  7674.5865
[43]   806.4323  4405.5330 30228.4057 33759.3535 32998.1212  7344.9950
[49] 24122.0167  8408.8140
> 
> 
> ## checking cesDerivCoef
> cesDeriv <- micEconCES:::cesDerivCoef( par = b, xNames = xNames, 
+    data = MishraCES, vrs = FALSE, nested = TRUE )
> f <- function( par ) {
+    return( cesCalc( xNames = xNames, data = MishraCES, coef = par, 
+       nested = TRUE ) )
+ }
> cesDerivNum <- numericGradient( f, t0 = b )
> all.equal( cesDeriv, cesDerivNum )
[1] TRUE
> print( cesDeriv )
         gamma_1    gamma_2      delta_1    delta_2         rho_1           rho
 [1,] 1820.62563  39.513572  -4163.03560 15005.1492  -603.1937286 -2711.2417127
 [2,]  357.55170  15.575048   -453.86859 11630.1845   -35.4754748 -4072.9489164
 [3,] 5633.25384  90.193206   7827.64118 10797.9457  -640.9370451  -650.9620245
 [4,] 3785.77924  64.206809   5689.21372 11249.1646  -503.2812567  -977.0554131
 [5,] 7102.90779 128.090421  -1029.35264 29578.1218    -8.9725914 -3340.0900197
 [6,] 3442.42056  71.814364  -1805.31643 25152.1416   -57.3494887 -4210.1812792
 [7,] 2559.75328  62.794639    442.50937 29140.8162    -4.5770178 -6369.9462968
 [8,] 6592.32156  98.239540  12058.26115  4515.0194 -1294.9236863  -107.0599786
 [9,] 3501.65102  44.368996   3537.88084 -6282.8773  -211.4649921  -499.7910676
[10,]  393.53429   4.249030   2850.77591 -1525.4313 -1261.8130389  -367.7845730
[11,] 1255.97900  39.193816   -126.49986 23612.5096    -0.7657558 -6646.4576729
[12,] 4342.34063  70.317660   6168.02134  9204.6914  -516.1249744  -604.7256294
[13,] 4642.02622  62.811429  18013.91000 -3892.4788 -4084.6217963  -130.0705581
[14,] 4012.73486  59.201525  -9256.53622  2085.2685 -1353.9335805   -38.0434344
[15,]  660.40961  22.965954   1206.59923 15035.0339  -129.4292788 -4597.9225912
[16,] 1363.70130  29.985920   4178.57537 11671.6361  -747.7063384 -2158.7567817
[17,] 3950.24532  58.581520 -10621.24712  2388.2716 -1834.5724875   -50.3286080
[18,] 6183.17290  90.107570   2858.19668  1973.9209   -78.7102550   -22.5086331
[19,] 5446.86702  81.686142   6784.11958  4304.1733  -498.6166905  -116.7305461
[20,] 1600.74481  42.100260   -652.45493 21369.4188   -16.0725386 -5090.3592256
[21,] 4414.58838  56.526834  19063.29667 -7265.2381 -4818.3190869  -520.7374605
[22,] 1536.89866  18.870948   2086.93194 -3427.4966  -167.0380024  -358.2341411
[23,] 4295.94167  54.236588  17184.72337 -7926.6745 -4018.1902838  -652.4856728
[24,] 6350.95691  91.735533 -12870.84852  1119.5297 -1639.5171027    -7.1384406
[25,] 6811.62174 108.457299    856.36143 12387.1300    -6.4464987  -713.6002724
[26,] 5950.80903 102.610969  -1608.28006 19554.9016   -26.2025743 -1840.1631281
[27,] 7796.72990 123.047569  -5862.67013 12961.9041  -268.2738160  -690.5980262
[28,] 1179.40239  15.215948   8778.90334 -1814.0637 -4015.1968728  -120.0009757
[29,] 3936.50055  52.968407  18669.12845 -3630.3506 -5196.1680729  -134.5800644
[30,] 2325.91185  31.472985  -3291.17656 -1949.2522  -287.8014924   -65.0962360
[31,] 4185.59457  59.586198  -7976.45672  -231.1223  -952.0299864    -0.4713835
[32,] 1308.42605  28.574249   5843.21837 10980.4984 -1528.6122844 -2006.4358538
[33,] 1596.90881  31.102188    134.85584  9210.2273    -0.6823512 -1315.8092964
[34,]  835.66374  10.739787  -3117.38449 -1331.4075  -780.2805067   -91.8160104
[35,] 3224.78962  55.436018  -6525.69941 10408.4387  -829.9547506  -965.6692642
[36,] 6329.89921  92.460487   6312.89777  2259.2838  -372.5203891   -28.7091577
[37,] 5323.74888  81.057599  -6019.81234  5560.0486  -417.7459561  -195.2194018
[38,]   79.95068   3.983892     71.92769  3157.4887    -3.8331321 -1178.7510422
[39,] 5397.63804  89.505031  -3238.17299 13773.2407  -117.8517343 -1056.7783754
[40,] 6237.09033  89.664605  13599.31401   625.9053 -1736.9201392    -2.2874565
[41,]  272.72675   2.915455   2426.02877 -1089.6015 -1408.4275990  -278.6907970
[42,] 1824.56551  27.543728  -4217.56936  1642.7845  -618.2624306   -50.3076953
[43,]  338.12739   3.552132  -1913.17316 -1420.2887  -830.4097730  -403.6555177
[44,]  917.29346  16.629547   1121.36511  3917.0609   -80.9123245  -450.7327494
[45,] 5866.86730  95.776578  -3727.14139 13293.5419  -143.7460962  -923.9124048
[46,] 7153.68551 105.895249 -11081.07504  4110.8247 -1064.4524824   -82.5463146
[47,] 6392.21955 103.722271  -1674.28224 13783.1651   -26.4323929  -918.7096580
[48,] 2020.48046  26.466242  -6982.65254 -2664.1827 -1598.6379343  -147.3642361
[49,] 3820.92970  78.012990   5306.16505 26031.4226  -434.2189301 -4162.5959977
[50,] 2308.90427  29.929208  11779.65485 -3394.5984 -3537.8111866  -212.9702206
> 
> # VRE
> cesDerivVrs <- micEconCES:::cesDerivCoef( par = bVrs, xNames = xNames, 
+    data = MishraCES, vrs = TRUE, nested = TRUE )
> cesDerivVrsNum <- numericGradient( f, t0 = bVrs )
> all.equal( cesDerivVrs, cesDerivVrsNum )
[1] TRUE
> print( cesDerivVrs )
         gamma_1    gamma_2      delta_1     delta_2        rho_1           rho
 [1,]  2892.5972  57.071714  -6614.20177  23840.0757  -958.349966  -4307.601819
 [2,]   517.5764  20.496151   -657.00057  16835.3530   -51.352766  -5895.825027
 [3,]  9720.0699 141.478748  13506.44258  18631.6453 -1105.924404  -1123.222310
 [4,]  6314.0218  97.350726   9488.61974  18761.6516  -839.385669  -1629.558623
 [5,] 12693.4749 208.098197  -1839.53702  52858.5132   -16.034752  -5969.012965
 [6,]  5806.0095 110.111442  -3044.85875  42421.7702   -96.726031  -7100.919886
 [7,]  4259.7396  94.998079    736.38921  48493.8486    -7.616712 -10600.362391
 [8,] 11472.5432 155.422879  20984.85642   7857.4375 -2253.541146   -186.315278
 [9,]  5628.2516  64.831723   5686.48434 -10098.5547  -339.890578   -803.321029
[10,]   500.2698   4.910422   3623.97129  -1939.1630 -1604.045484   -467.536129
[11,]  1993.8699  56.563894   -200.81886  37484.9199    -1.215639 -10551.268705
[12,]  7308.4119 107.589738  10381.13871  15492.0311  -868.668354  -1017.788411
[13,]  7725.1006  95.026021  29978.13019  -6477.7294 -6797.487276   -216.458955
[14,]  6638.4462  89.036112 -15313.50059   3449.7527 -2239.872691    -62.936950
[15,]   993.8355  31.419041   1815.78398  22625.8835  -194.775203  -6919.310008
[16,]  2107.6752  42.131712   6458.21743  18039.1537 -1155.621158  -3336.477015
[17,]  6528.1905  88.010949 -17552.71343   3946.8667 -3031.821479    -83.173249
[18,] 10667.9311 141.330992   4931.29431   3405.6386  -135.800113    -38.834519
[19,]  9305.8125 126.871251  11590.46922   7353.5538  -851.871984   -199.430713
[20,]  2559.4301  61.194622  -1043.20986  34167.5527   -25.698374  -8138.972749
[21,]  7269.5640  84.621385  31391.79560 -11963.7685 -7934.393013   -857.505614
[22,]  2267.8655  25.314718   3079.50096  -5057.6537  -246.483212   -528.614450
[23,]  7044.9886  80.857740  28181.52347 -12999.0898 -6589.499367  -1070.022479
[24,] 10977.0492 144.142266 -22246.08656   1935.0050 -2833.755625    -12.338143
[25,] 11972.0656 173.294454   1505.13572  21771.5454   -11.330327  -1254.219564
[26,] 10401.3109 163.047133  -2811.08347  34179.6570   -45.799003  -3216.387669
[27,] 13877.5397 199.104164 -10435.07195  23071.1260  -477.505388  -1229.207841
[28,]  1703.2743  19.976938  12678.35345  -2619.8421 -5798.683858   -173.303512
[29,]  6440.2791  78.780476  30543.47315  -5939.4051 -8501.147785   -220.178601
[30,]  3612.2661  44.435670  -5111.37401  -3027.2933  -446.971179   -101.097952
[31,]  6928.9019  89.672699 -13204.35724   -382.6037 -1576.006050     -0.780336
[32,]  2012.5160  39.955108   8987.56998  16889.3222 -2351.188849  -3086.138751
[33,]  2477.1477  43.860142    209.19030  14287.0357    -1.058473  -2041.102098
[34,]  1165.5309  13.617432  -4347.93078  -1856.9629 -1088.285914   -128.059166
[35,]  5299.9683  82.826866 -10725.04081  17106.3548 -1364.037478  -1587.085400
[36,] 10949.2683 145.395777  10919.85972   3908.0408  -644.374507    -49.660233
[37,]  9088.4458 125.797818 -10276.73155   9491.8451  -713.155627   -333.269091
[38,]   100.9824   4.574444     90.84887   3988.0927    -4.841470  -1488.831450
[39,]  9306.3887 140.291770  -5583.12660  23747.2633  -203.195183  -1822.054436
[40,] 10755.6540 140.566925  23451.56289   1079.3528 -2995.260780     -3.944642
[41,]   333.8805   3.244718   2970.01928  -1333.9237 -1724.240522   -341.181872
[42,]  2796.1111  38.372932  -6463.34280   2517.5353  -947.475118    -77.095562
[43,]   422.2036   4.032162  -2388.88843  -1773.4470 -1036.893234   -504.025469
[44,]  1336.5617  22.027665   1633.90863   5707.4361  -117.895005   -656.749637
[45,] 10184.1522 151.142028  -6469.85407  23075.9360  -249.525351  -1603.797067
[46,] 12543.2528 168.796768 -19429.52703   7207.9090 -1866.408106   -144.736485
[47,] 11184.8862 164.990606  -2929.60155  24117.3089   -46.250493  -1607.526603
[48,]  3084.0156  36.724975 -10658.16269  -4066.5481 -2440.124737   -224.933433
[49,]  6497.9808 120.610084   9023.81395  44269.7715  -738.444960  -7079.028162
[50,]  3567.8627  42.044070  18202.65649  -5245.5450 -5466.846234   -329.094852
               nu
 [1,]  41966.4776
 [2,]  11255.1340
 [3,] 127386.1657
 [4,]  81036.8714
 [5,] 201969.1405
 [6,]  94125.1220
 [7,]  78655.9333
 [8,] 142597.6563
 [9,]  49175.3931
[10,]   1420.7724
[11,]  41501.1438
[12,]  91516.3256
[13,]  78684.1501
[14,]  72670.3363
[15,]  19693.5359
[16,]  28655.6981
[17,]  71648.2930
[18,] 127226.2771
[19,] 111719.8898
[20,]  45774.2369
[21,]  68284.6419
[22,]  14873.0227
[23,]  64578.7441
[24,] 130273.1796
[25,] 162423.9191
[26,] 151012.4562
[27,] 191640.5863
[28,]  10876.8200
[29,]  62546.9020
[30,]  30652.8765
[31,]  73306.0682
[32,]  26789.9475
[33,]  30151.9013
[34,]   6465.4348
[35,]  66513.7757
[36,] 131634.9798
[37,] 110580.3079
[38,]   1264.6137
[39,] 126102.5156
[40,] 126399.9183
[41,]    694.3865
[42,]  25447.2007
[43,]   1022.1916
[44,]  12384.7510
[45,] 137902.5358
[46,] 157401.3110
[47,] 153167.9354
[48,]  24061.2492
[49,] 105096.6202
[50,]  28580.1701
> 
> 
> 

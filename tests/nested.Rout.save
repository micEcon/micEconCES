
R version 2.11.1 (2010-05-31)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library( "micEconCES" )
Loading required package: systemfit
Loading required package: Matrix
Loading required package: lattice

Attaching package: 'Matrix'

The following object(s) are masked from 'package:base':

    det

Loading required package: car
Loading required package: MASS
Loading required package: nnet
Loading required package: survival
Loading required package: splines
Loading required package: lmtest
Loading required package: zoo
Loading required package: miscTools

Attaching package: 'miscTools'

The following object(s) are masked from 'package:car':

    coefTable

Loading required package: micEcon
Loading required package: np
Loading required package: boot

Attaching package: 'boot'

The following object(s) are masked from 'package:car':

    logit

The following object(s) are masked from 'package:survival':

    aml

The following object(s) are masked from 'package:lattice':

    melanoma

Loading required package: cubature
Nonparametric Kernel Methods for Mixed Datatypes (version 0.40-3)
Loading required package: minpack.lm
Loading required package: DEoptim
> library( maxLik )
> 
> data( "MishraCES" )
> 
> b <- c( "gamma" = 200, "delta_1" = 0.6, "delta_2" = 0.3, "rho_1" = 0.5,
+    "rho_2" = -0.17, "rho" = 0.6 )
> bVrs <- c( b, "nu" = 1.05 )
> xNames <- c( "X1", "X2", "X3", "X4" )
> 
> 
> ## checking cesCalc()
> MishraCES$Y2 <- cesCalc( xNames = xNames, 
+    data = MishraCES, coef = b, nested = TRUE )
> 
> MishraCES$Y2
 [1] 2568.8806 1769.6854 3032.1632 3166.2899 2158.8779 3486.6684 3600.4642
 [8] 2185.4544 1897.9213  225.0079 3793.8998 1930.1046 2720.3640 2576.2448
[15] 2350.2216 1783.9233 1773.0890 2919.1492 2565.7156 3362.0073 2586.1524
[22]  585.0622 1745.4600 3495.8489 4693.7705 4185.2734 5215.1572  745.0312
[29] 2022.2339 1295.2980 2274.0014 2186.0857 1947.6375  656.9261 3103.8441
[36] 3908.0110  438.4530 1370.1318 2040.7880 3913.0637  147.5080 1057.7514
[43]  178.7087 1274.5901 2382.3232 4558.1732 4536.7109 1420.3603 3645.6197
[50] 1352.6723
> 
> all.equal( MishraCES$Y, MishraCES$Y2 )
[1] "Mean relative difference: 9.561409e-06"
> 
> # VRS
> MishraCES$yVrs <- cesCalc( xNames = xNames, 
+    data = MishraCES, coef = bVrs, nested = TRUE )
> MishraCES$yVrs
 [1] 2918.6339 1973.5102 3473.6711 3635.1867 2431.5767 4022.3483 4160.3026
 [8] 2463.0166 2123.9320  226.3373 4395.3012 2161.7646 3099.6086 2927.4196
[15] 2658.3536 1990.1852 1977.4958 3337.8561 2914.8582 3871.4806 2939.2418
[22]  617.3204 1945.1536 4033.4696 5495.9965 4872.5749 6138.7404  795.6676
[29] 2270.2383 1422.1215 2567.9039 2463.7636 2182.3884  697.1735 3559.9459
[36] 4534.2146  456.0029 1508.5127 2292.1144 4540.3701  145.2797 1149.6120
[43]  177.7057 1398.2588 2696.4925 5329.4067 5303.0615 1566.6318 4215.1053
[50] 1488.3352
> 
> 
> ## checking cesDerivCoef
> cesDeriv <- micEconCES:::cesDerivCoef( par = b, xNames = xNames, 
+    data = MishraCES, vrs = FALSE, nested = TRUE )
> f <- function( par ) {
+    return( cesCalc( xNames = xNames, data = MishraCES, coef = par, 
+       nested = TRUE ) )
+ }
> cesDerivNum <- numericGradient( f, t0 = b )
> all.equal( cesDeriv, cesDerivNum )
[1] TRUE
> 
> # VRE
> cesDerivVrs <- micEconCES:::cesDerivCoef( par = bVrs, xNames = xNames, 
+    data = MishraCES, vrs = TRUE, nested = TRUE )
> cesDerivVrsNum <- numericGradient( f, t0 = bVrs )
> 
> all.equal( cesDerivVrs, cesDerivVrsNum )
[1] TRUE
> 
> 
